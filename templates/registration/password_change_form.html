{% extends 'base.html' %}
{% block title %}Cambiar contraseña{% endblock %}
{% block content %}
<div class="container mt-4">
  <h3>Cambiar contraseña</h3>
  <form method="post">{% csrf_token %}
    {{ form.as_p }}
    <div class="mb-3">
      <label class="form-label">Requisitos de la contraseña</label>
      <ul id="pw-reqs">
        <li id="req-length">Longitud mínima 8</li>
        <li id="req-upper">Al menos una mayúscula</li>
        <li id="req-lower">Al menos una minúscula</li>
        <li id="req-digit">Al menos un número</li>
        <li id="req-special">Al menos un caracter especial</li>
      </ul>
    </div>
    <button class="btn btn-primary" id="pw-submit">Actualizar contraseña</button>
  </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
const pwdInputs = document.querySelectorAll('input[type="password"]');
const pw = pwdInputs[0];
function checkPwd() {
  const v = pw.value || '';
  document.getElementById('req-length').style.color = v.length >= 8 ? 'green' : 'red';
  document.getElementById('req-upper').style.color = /[A-Z]/.test(v) ? 'green' : 'red';
  document.getElementById('req-lower').style.color = /[a-z]/.test(v) ? 'green' : 'red';
  document.getElementById('req-digit').style.color = /[0-9]/.test(v) ? 'green' : 'red';
  document.getElementById('req-special').style.color = /[^A-Za-z0-9]/.test(v) ? 'green' : 'red';
}
if (pwdInputs.length>0) {
  pwdInputs.forEach(i => i.addEventListener('input', checkPwd));
}
</script>
{% endblock %}
